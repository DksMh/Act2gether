<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>여기부터 - 투어 탐색</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/community-search.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="/js/community-search.js"></script>
  </head>
  <body>
    <!-- Header -->
    <div th:replace="header :: header"></div>

    <div class="container">
      <br /><br />
      <!-- 상단 타이틀 -->
      <h2 class="h1">함께 여행을 떠날 인연을 맺어보세요 <small>🍀</small></h2>
      <p class="subtle">
        <span id="userName" th:text="${username}"></span>님이 현재 가입중인 여행
      </p>

      <!-- 가입 중인 여행 가로 스크롤 카드 -->
      <div id="enrolledScroller"></div>
      <div class="hr"></div>
      <br /><br />
      <!-- 내 지역 출발 모임 -->
      <h2 class="h1">내 지역 출발 모임</h2>
      <p class="subtle">
        <span id="myCity" style="color: #ef4444; font-weight: 800">서울</span>
        지역의 투어 모임을 추천해 드립니다.
      </p>
      <!-- 카드 그리드 -->
      <div id="localGrid" class="local-grid" aria-live="polite"></div>

      <!-- 더보기/축소 -->
      <div class="grid-actions">
        <button type="button" id="localMoreBtn" class="btn more" hidden>더 보기</button>
        <button type="button" id="localLessBtn" class="btn less" hidden>축소</button>
      </div>

      <div class="hr"></div>

      <br /><br />
      <!-- 모임 찾기 -->
      <h2 class="h1">모임 찾기</h2>
      <div class="filters">
        <div class="select">
          출발 지역
          <!-- 출발 지역 -->
            <select id="filterFrom">
              <option value="">출발 지역 선택</option>
              <option value="서울">서울</option>
              <option value="경기">경기</option>
              <option value="인천">인천</option>
              <option value="부산">부산</option>
              <option value="대구">대구</option>
              <option value="광주">광주</option>
              <option value="대전">대전</option>
              <option value="울산">울산</option>
              <option value="강원">강원</option>
              <option value="충북">충북</option>
              <option value="충남">충남</option>
              <option value="전북">전북</option>
              <option value="전남">전남</option>
              <option value="경북">경북</option>
              <option value="경남">경남</option>
              <option value="제주">제주</option>
            </select>
        </div>
        <div class="select">
          도착 지역
          <select id="filterTo">
              <option value="">도착 지역 선택</option>
              <option value="전체">전체</option>
              <option value="서울">서울</option>
              <option value="경기">경기</option>
              <option value="인천">인천</option>
              <option value="부산">부산</option>
              <option value="대구">대구</option>
              <option value="광주">광주</option>
              <option value="대전">대전</option>
              <option value="울산">울산</option>
              <option value="강원">강원</option>
              <option value="충북">충북</option>
              <option value="충남">충남</option>
              <option value="전북">전북</option>
              <option value="전남">전남</option>
              <option value="경북">경북</option>
              <option value="경남">경남</option>
              <option value="제주">제주</option>
            </select>
        </div>
        <div class="date">
          여행 시작일
          <input id="filterStart" type="date" />
        </div>
        <div class="date">
          여행 종료일
          <input id="filterEnd" type="date" />
        </div>
        <!-- ✅ 종료일 옆 “전체보기” 체크박스 -->
         <div class="checkbox">
             <label class="all-toggle">
                <input type="checkbox" id="allToggle" />
                전체보기
              </label>
         </div>
 
        <div class="search">
          <button type="button" id="searchBtn" class="btn search" >검색</button>
        </div>
      </div>
      <div id="searchGrid" class="search-grid"></div>
      <!-- 더보기/축소 -->
      <div class="grid-actions">
        <button type="button" id="searchMoreBtn" class="btn more" hidden>더 보기</button>
        <button type="button" id="searchLessBtn" class="btn less" hidden>축소</button>
      </div>
      <br />
    </div>
    <!-- Footer -->
    <div th:replace="footer :: footer"></div>
  </body>
  <script th:inline="javascript">
    /* =========== init =========== */
    window.currentUser = {
      username: /*[[${username}]]*/ "",
    };
    renderEnrolled();
    renderLocal();
    // renderLocal('서울');
    // buildFilters();
    // renderSearch();

    // ["change", "input"].forEach((ev) => {
    //   $("#filterFrom").addEventListener(ev, () => {
    //     // renderSearch();
    //     renderLocal($("#filterFrom").value || "서울");
    //   });
    //   $("#filterTo").addEventListener(ev, renderSearch);
    //   $("#filterStart").addEventListener(ev, renderSearch);
    //   $("#filterEnd").addEventListener(ev, renderSearch);
    // });

    // 사용자 이름 표기 (백엔드에서 window.currentUserName 주입한다고 가정)
    if (window.currentUserName)
      $("#userName").textContent = window.currentUserName;
  </script>
</html>
