<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>여기부터 - 투어 검색 v2.0</title>
    <!-- CSS 파일들 -->
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/tour-search.css" />
    <!-- 폰트 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- JavaScript 파일들 -->
    <script src="/js/tour-utils.js"></script>
    <script src="/js/tour-search.js"></script>
  </head>
  
  <body>
    <!-- Header -->
    <div th:replace="~{header :: header}"></div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
      <div class="spinner"></div>
    </div>

    <!-- Main Container -->
    <div class="tour-search-container">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">🎯 어떤 여행을 떠나볼까요? <span class="version-badge">v2.0</span></h1>
        <p class="page-subtitle">
          ✨ <strong>v2.0 개선됨!</strong> 관심사 정보로 미리 설정되어 있습니다.
          <span style="color: #4CAF50; font-weight: 600;">회색 박스</span>는 회원님의 관심사, 
          <span style="color: #2196F3; font-weight: 600;">파란 박스</span>는 직접 변경하신 값입니다!
        </p>
      </div>

      <!-- Search Filters -->
      <div class="search-filters">
        <div class="filter-row">
          <!-- 지역 선택기 (JavaScript에서 사이드 메뉴로 동적 생성됨) -->
          <div class="filter-group">
            <label for="regionFilter">여행 지역 <small>(17개 광역시도)</small></label>
            <select class="filter-select" id="regionFilter">
              <option value="">지역 선택</option>
            </select>
          </div>

          <!-- 테마 선택기 (JavaScript에서 사이드 메뉴로 동적 생성됨) -->
          <div class="filter-group">
            <label for="themeFilter">선호 테마 <small>(메인 3개)</small></label>
            <select class="filter-select" id="themeFilter">
              <option value="">테마 선택</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="activityFilter">선호 활동</label>
            <select class="filter-select" id="activityFilter">
              <option value="">활동 선택</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="placeFilter">장소</label>
            <select class="filter-select" id="placeFilter">
              <option value="">장소 선택</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="needsFilter">편의 시설</label>
            <select class="filter-select" id="needsFilter">
              <option value="">편의시설 선택</option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="curationCount">방문지 수</label>
            <select class="filter-select" id="curationCount">
              <option value="3">3개 (간단)</option>
              <option value="6" selected>6개 (적당)</option>
              <option value="9">9개 (풍성)</option>
              <option value="12">12개 (완전)</option>
              <option value="15">15개 (최대)</option>
            </select>
          </div>
          
          <div class="filter-group">
            <button id="doSearchBtn" class="btn-primary">🔍 검색하기</button>
            <button id="clearFiltersBtn" class="btn-secondary">🔄 초기화</button>
          </div>
        </div>

        <!-- Interest Tags -->
        <div class="interest-tags" id="interestTags">
          <div class="text-center" style="color: #666; font-size: 14px; font-style: italic;">
            v2.0 개선: 로그인 후 설정된 관심사가 여기에 표시됩니다
          </div>
        </div>
      </div>
      <!-- Recommended Tours Section -->
      <div class="tours-section">
        <div class="section-header">
          <h2 class="section-title">📌 회원님을 위한 맞춤 투어</h2>
          <div class="section-subtitle">관심사 기반 추천 콘텐츠 (v2.0)</div>
        </div>
        <div class="tour-list" id="recommendedTours">
          <div class="recommendation-placeholder">
            <div class="placeholder-icon">🎯</div>
            <h3>v2.0 맞춤 추천을 준비 중입니다</h3>
            <p>검색 조건을 설정하고 검색버튼을 눌러주세요!</p>
            <div class="improvement-note">
              <small>🎨 메인 3개 카테고리 기반 균형잡힌 추천</small>
            </div>
          </div>
        </div>
      </div>

      <!-- 기존의 "투어 검색 결과" 섹션을 "이런 코스는 어떠세요?" 섹션으로 변경 -->
      <!-- Search Results Section → Recommended Courses Section으로 변경 -->
      <div class="tours-section">
        <div class="section-header">
          <h2 class="section-title">🔍 이런 코스는 어떠세요?</h2>
          <div class="section-subtitle">선택하신 조건에 맞는 추천 여행코스</div>
          <div class="result-count" id="resultCount" style="display: none;">
            총 <span class="count-number">0</span>개의 코스
          </div>
        </div>
        
        <!-- 지역+테마 조합 코스 -->
        <div class="course-section" id="coursesByTheme">
          <h3 class="course-section-title">
            <span class="course-icon">🎨</span>
            선택하신 지역 + 테마 조합 코스
          </h3>
          <div class="tour-list" id="themeBasedCourses">
            <div class="search-placeholder">
              <div class="placeholder-icon">🎨</div>
              <h4>지역과 테마를 선택하면 맞춤 코스가 표시됩니다</h4>
              <p>위의 필터에서 지역과 선호테마를 설정해주세요!</p>
            </div>
          </div>
        </div>
        
        <!-- 지역+활동 조합 코스 -->
        <div class="course-section" id="coursesByActivity">
          <h3 class="course-section-title">
            <span class="course-icon">🎯</span>
            선택하신 지역 + 활동 조합 코스
          </h3>
          <div class="tour-list" id="activityBasedCourses">
            <div class="search-placeholder">
              <div class="placeholder-icon">🎯</div>
              <h4>지역과 활동을 선택하면 맞춤 코스가 표시됩니다</h4>
              <p>위의 필터에서 지역과 선호활동을 설정해주세요!</p>
            </div>
          </div>
        </div>

        <!-- No Results Message (코스용으로 수정) -->
        <div class="no-results" id="noCourses" style="display: none">
          <div class="no-results-icon">😅</div>
          <h3>추천 코스가 없습니다</h3>
          <p>다른 지역이나 테마/활동을 선택해보시거나 메인 3개 카테고리를 확인해주세요</p>
          <div class="main-category-suggestions">
            <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('nature')">🌿 자연 코스</button>
            <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('culture')">🏛️ 문화 코스</button>
            <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('activity')">🏃‍♂️ 레포츠 코스</button>
          </div>
          <button class="retry-search-btn" onclick="tourSearchManager.clearFilters()">필터 초기화하고 다시 검색</button>
        </div>
      </div>

      <!-- Pagination -->
      <div class="pagination" id="pagination" style="display: none;">
        <button class="pagination-btn prev" id="prevBtn">&lt;</button>
        <div class="pagination-numbers" id="paginationNumbers"></div>
        <button class="pagination-btn next" id="nextBtn">&gt;</button>
      </div>

      <!-- No Results Message -->
      <!-- <div class="no-results" id="noResults" style="display: none">
        <div class="no-results-icon">😅</div>
        <h3>검색 결과가 없습니다</h3>
        <p>다른 조건으로 검색해보시거나 메인 3개 카테고리를 확인해주세요</p>
        <div class="main-category-suggestions">
          <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('nature')">🌿 자연 여행</button>
          <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('culture')">🏛️ 문화 여행</button>
          <button class="suggestion-btn" onclick="tourSearchManager.applyQuickFilter('activity')">🏃‍♂️ 레포츠</button>
        </div>
        <button class="retry-search-btn" onclick="tourSearchManager.clearFilters()">필터 초기화하고 다시 검색</button>
      </div> -->
    </div>

    <!-- Footer -->
    <div th:replace="~{footer :: footer}"></div>

    <!-- 모달 - 상세 정보 -->
    <div class="modal-overlay" id="tourDetailModal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">투어 상세 정보</h2>
          <button class="modal-close" onclick="tourSearchManager.closeModal()">&times;</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer">
          <small>🎯 v2.0: 메인 3개 카테고리 기반 투어 정보</small>
        </div>
      </div>
    </div>

    <!-- 개선 완료 토스트 -->
    <div class="improvement-toast" id="improvementToast">
      <div class="toast-content">
        <span class="toast-icon">🎉</span>
        <div class="toast-text">
          <strong>v2.0 투어 검색 시스템이 개선되었습니다!</strong>
          <br><small>메인 3개 카테고리 · 5개 질문 구조 · 실시간 필터</small>
        </div>
        <button class="toast-close" onclick="document.getElementById('improvementToast').style.display='none'">×</button>
      </div>
    </div>
  </body>
</html>